<!DOCTYPE html>
<html>
<head>

<script src='src/mapbox-gl.js'></script>
<link href='src/mapbox-gl.css' rel='stylesheet' />
<script src='src/demo.json'></script>
	
</head>
<body>


<div id='map' style='width: 100%; height: 90%;display: block;position: absolute;border: 1px solid red;'></div>
<style>
.mapboxgl-canvas{
  cursor: pointer;
}
</style>
<script>

var emptyJson = {
            "version": 8,
            "staticMapColor":"#ffffff",
            "adminLineClr":"#d3d7db",
            "PrimaryFontColor":"#969ea6",
            "secondaryFntClr":"#bdc4ca",
            "ternaryFntClr":"#d5dade",
            "textHaloClr":"rgba(255,255,255,0.8)",
            "name": "Empty",
            "metadata": {
              "mapbox:autocomposite": true
            },
            "sources": {},
            "layers": [
              {
                "id": "background",
                "type": "background",
                "paint": {
                  "background-color": "grey"
                }
              }
            ]
          }
// mapboxgl.accessToken = 'undefined';
// mapboxgl.accessToken = 'pk.eyJ1Ijoiam9uYWhhZGtpbnMiLCJhIjoiRlVVVkx3VSJ9.9sdVEK_B_VkEXPjssU5MqA';
var map = new mapboxgl.Map({
    container: 'map',
	   zoom: 0,
    // maxZoom:0,
dragPan:false,
    renderWorldCopies:false,
    // style: "src/bright.json"
    style: emptyJson
});

var FeatureSet = {
    'type': 'FeatureCollection',
    'features': [

    ]
}



// var json=[
//   {
//     "Point": "point1",
//     "x": -240,
//     "y": 10,
//     "image": "resizeBasket.jpg",
//     "dimx": 467,
//     "dimy": 700
//   },
//   {
//     "Point": "point2",
//     "x": -100,
//     "y": 20,
//     "image": "resizeBasket.jpg",
//     "dimx": 467,
//     "dimy": 700
//   },
//   {
//     "Point": "point3",
//     "x": 0,
//     "y": 90,
//     "image": "resizeBasket.jpg",
//     "dimx": 467,
//     "dimy": 700
//   },
//   {
//     "Point": "point4",
//     "x": 250,
//     "y": 250,
//     "image": "resizeBasket.jpg",
//     "dimx": 467,
//     "dimy": 700
//   },
// ]


var xMin = 99999, xMax =-99999,  yMin = 99999, yMax =-99999;
findMinMax();
function findMinMax()
{
    json.forEach(function(d){
      if(d.x > xMax)
      {
          xMax = d.x;
      }
      if(d.x < xMin)
      {
          xMin = d.x;
      }

      if(d.y > yMax)
      {
          yMax = d.y;
      }
      if(d.y < yMin)
      {
          yMin = d.y;
      }

    });

}


console.log(xMin,xMax,yMin,yMax);

var _xfact,_yfact;
findLatLngFactors();
function findLatLngFactors()
{
  var xVal = Math.abs(xMax)+Math.abs(xMin);
  var yVal = Math.abs(yMin)+Math.abs(yMax);
     _xfact = Math.ceil(xVal/180);
     _yfact = Math.ceil(yVal/90);
}
console.log(_xfact,_yfact)

var pixelCalc = map.project([-180,85]);

var imgstrt=map.unproject([(0+pixelCalc.x),0]);

var imgend=map.unproject([(500+pixelCalc.x),413]);

console.log(pixelCalc,imgstrt,imgend);


json.forEach(function(d){
    var feature = {
                      'type': 'Feature',
                      "properties": {
                        "idx":0
                      },
                      'geometry': {
                          'type': 'Point',
                      }
                  }

        // console.log(d.x+263,d.y);

        var lngLat = map.unproject([d.x+250+pixelCalc.x,(d.y)]);
        console.log(d.x+250+pixelCalc.x,(d.y));
       
  feature.properties.Point=d.Point;
  // if((d.x+250 )< 0 )
  // {
  //   feature.properties.Point="point 2";
  // }
  feature.geometry.coordinates = [lngLat.lng,lngLat.lat];
  // console.log(d.x,d.y);
  FeatureSet.features.push(feature)
});

// 225+

console.log(FeatureSet);



var layer = {
    "id": "points",
    "source": "pointsource",
    // "type":"symbol",
    // "properties": {
    //                     "title": "Mapbox DC",
    //                     "icon": "monument"
    //                 }
    "type": "circle",
    "paint": {
      "circle-radius":5,
      "circle-color":[
                        'match',
                        ['get', 'Point'],
                        "point1", 'green',
                        "point2", 'red',
                        "point3",'yellow',
                        "point4",'orange',
                        "white"
                    ]
    }
  };


map.on('style.load', function () {

   map.addSource('pointsource',{
        type:'geojson',
        data:FeatureSet
      });

   map.addSource("overlay",{
          'type': 'image',
          'url': 'http://priya-4928.csez.zohocorpin.com:8000/half.jpg',
          'coordinates': [
                  
                    [
                      imgstrt.lng,
                        imgstrt.lat
                       
                    ],
                    [
                        imgend.lng,
                        imgstrt.lat
                        
                    ],
                    [ 
                       imgend.lng,
                       imgend.lat
                    ],
                    [
                        imgstrt.lng,
                       imgend.lat
                    ]
                    
              ] 
        });


   // map.addSource("overlay",{
   //        'type': 'image',
   //        'url': 'http://priya-4928.csez.zohocorpin.com:8000/half.jpg',
   //        'coordinates': [
                  
   //                  [
   //                      -180,
   //                     85
   //                  ],
   //                  [
   //                      81.77068857238953,
   //                      85.05113000000148
                        
   //                  ],
   //                  [ 
   //                      81.77068857238953,
   //                      -33.667455634360074
   //                  ],
   //                  [
   //                      -180,-33.667455634360074
   //                  ]
                    
   //            ] 
   //      });

   map.addLayer({

            'id': 'overlay',
            'source': 'overlay',
            'type': 'raster',
            'paint': { 'raster-opacity': 0.85 }
          });
   map.addLayer(layer);

});
map.setZoom(0);
map.setMaxZoom(0.5);
map.on("click",function(e){
console.log(e.lngLat);
console.log(e.point);
})

</script>


</body>
</html>
